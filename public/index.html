// 1) EXACT icon filenames by platform slug
const ICON_PATHS = {
  instagram: 'instagram.svg',
  tiktok: 'tiktok.svg',
  youtube: 'youtube.svg',
  facebook: 'facebook.svg',
  telegram: 'telegram.svg',
  twitter: 'specialtwitter.svg',
  x: 'x.svg',
  spotify: 'spotify.svg',
  soundcloud: 'soundcloud.svg',
  snapchat: 'snapchat.svg',
  threads: 'threads.svg',
  reddit: 'reddit.svg',
  linkedin: 'linkedin.svg',
  twitch: 'twitch.svg',
  pinterest: 'pinterest.svg',
  discord: 'discord.svg',
  quora: 'quora.svg',
  tumblr: 'tumblr.svg',
  vimeo: 'vimeo.svg',
  okru: 'okru.svg',
  vk: 'vkontakte.svg',
  kick: 'kick.svg',
  clubhouse: 'clubhouse.svg',
  audiomack: 'audiomack.svg',
  dailymotion: 'dailymotion.svg',
  reverbnation: 'reverbnation.svg',
  tidal: 'tidal.svg',
  shazam: 'shazam.svg',
  imdb: 'imdb.svg',
  rumble: 'rumble.svg',

  // SMM/traffic-y stuff
  exchange: 'exchange.svg',
  geotarget: 'geotarget.svg',
  googlereviews: 'googlereviews.svg',
  massdm: 'massdm.svg',
  mixcloud: 'mixcloud.svg',
  mobile: 'mobile.svg',
  ownwebsite: 'onwebsite.svg',
  websitepremium: 'websitepremium.svg',
  webtraffic: 'webtraffic.svg',
  worldwide: 'webtraffic.svg',
  worldwidemobile: 'mobile.svg',
  crypto: 'crypto.svg',
  datpiff: 'datpiff.svg',
  vpn: 'vpn.svg',

  // true “other”
  other: 'specialservices.svg'
};

// 2) Robust platform detection (ORDER MATTERS; uses word boundaries)
const PLATFORM_RULES = [
  { slug:'instagram',   re:/\binstagram\b/i },
  { slug:'tiktok',      re:/\btik\s*tok\b|\btiktok\b/i },
  { slug:'youtube',     re:/\byou\s*tube\b|\byoutube\b/i },
  { slug:'facebook',    re:/\bfacebook\b|\bfb\b/i },
  { slug:'telegram',    re:/\btelegram\b/i },
  { slug:'twitter',     re:/\btwitter\b/i },
  { slug:'x',           re:/\bx\b(?!\w)/i }, // literal “X”
  { slug:'spotify',     re:/\bspotify\b/i },
  { slug:'soundcloud',  re:/\bsound\s*cloud\b|\bsoundcloud\b/i },
  { slug:'snapchat',    re:/\bsnap\s*chat\b|\bsnapchat\b/i },
  { slug:'threads',     re:/\bthreads\b/i },
  { slug:'reddit',      re:/\breddit\b/i },
  { slug:'linkedin',    re:/\blinked?in\b|\blinkedin\b/i },
  { slug:'twitch',      re:/\btwitch\b/i },
  { slug:'pinterest',   re:/\bpint?erest\b|\bpinterest\b/i },
  { slug:'discord',     re:/\bdiscord\b/i },
  { slug:'quora',       re:/\bquora\b/i },
  { slug:'tumblr',      re:/\btumblr\b/i },
  { slug:'vimeo',       re:/\bvimeo\b/i },
  { slug:'okru',        re:/\bok\.?ru\b|\bokru\b/i },
  { slug:'vk',          re:/\bvk(?:ontakte)?\b|\bvkontakte\b/i },
  { slug:'kick',        re:/\bkick\b/i },
  { slug:'clubhouse',   re:/\bclubhouse\b/i },
  { slug:'audiomack',   re:/\baudio\s*mack\b|\baudiomack\b/i },
  { slug:'dailymotion', re:/\bdaily\s*motion\b|\bdailymotion\b/i },
  { slug:'reverbnation',re:/\breverb\s*nation\b|\breverbnation\b/i },
  { slug:'tidal',       re:/\btidal\b/i },
  { slug:'shazam',      re:/\bshazam\b/i },
  { slug:'imdb',        re:/\bimdb\b/i },
  { slug:'rumble',      re:/\brumble\b/i },

  // traffic / misc (keep after socials to avoid collisions)
  { slug:'mixcloud',    re:/\bmixcloud\b/i },
  { slug:'massdm',      re:/\bmass\s*dm\b|\bmassdm\b/i },
  { slug:'geotarget',   re:/\bgeo\s*target(?:ed)?\b|\bgeotarget\b/i },
  { slug:'googlereviews',re:/\bgoogle\s*reviews?\b/i },
  { slug:'exchange',    re:/\bexchange\b/i },
  { slug:'mobile',      re:/\bmobile\s*traffic\b|\bmobile\b/i },
  { slug:'ownwebsite',  re:/\bown\s*website\b/i },
  { slug:'websitepremium', re:/\bwebsite\s*premium\b/i },
  { slug:'webtraffic',  re:/\bweb\s*traffic\b/i },
  { slug:'worldwidemobile', re:/\bworld\s*wide.*mobile|\bworldwide.*mobile\b/i },
  { slug:'worldwide',   re:/\bworld\s*wide\b|\bworldwide\b/i },
  { slug:'crypto',      re:/\bcrypt(o|ocurrency)\b/i },
  { slug:'datpiff',     re:/\bdatpiff\b/i },
  { slug:'vpn',         re:/\bvpn\b/i }
];

// 3) helpers
function getPlatformSlug(text=''){
  const t = String(text).toLowerCase();
  for (const rule of PLATFORM_RULES){
    if (rule.re.test(t)) return rule.slug;
  }
  return 'other';
}
function iconForCategory(cat){
  const slug = getPlatformSlug(cat);
  const file = ICON_PATHS[slug] || ICON_PATHS.other;
  return `/icons/${file}`;
}